# Mobile Demo - 開発支援Webアプリ MVP スペック

## 1. 概要

### 1.1 目的
携帯電話会社の開発チームが共通で抱えている課題を解決するための開発支援Webアプリケーション。

### 1.2 対象ユーザー
- 携帯電話会社の開発チームメンバー
- API開発者
- テストエンジニア
- デバッグ担当者

### 1.3 技術スタック
- **バックエンド**: FastAPI
- **フロントエンド**: htmx (HTML + HTMX)
- **データベース**: SQLModel (SQLite for MVP)
- **原則**: DRY原則に従った設計

## 2. 開発チームが抱える共通課題

### 2.1 課題リスト
1. **API仕様の共有・管理**
   - 複数のチーム間でAPI仕様が分散している
   - 最新版の仕様がどこにあるか分からない
   - 仕様の変更履歴が追えない

2. **テストデータの管理**
   - テストデータが各開発者のローカルに散在
   - テストデータの再利用が困難
   - テストデータのバージョン管理ができていない

3. **モックサーバーの構築**
   - 外部API依存の開発が困難
   - モックサーバーの構築に時間がかかる
   - モックデータの管理が煩雑

4. **ログの確認・検索**
   - 開発ログが各環境に分散
   - ログの検索が困難
   - エラーパターンの分析ができない

5. **環境設定の管理**
   - 環境変数の管理が煩雑
   - 環境ごとの設定差分が不明確
   - 設定の共有が困難

## 3. MVP機能要件

### 3.1 機能一覧（優先順位順）

#### Phase 1: コア機能（MVP）
1. **API仕様管理**
   - API仕様の登録・編集・削除
   - OpenAPI形式の仕様書のアップロード・表示
   - 仕様のバージョン管理
   - 仕様の検索機能

2. **テストデータ管理**
   - テストデータの登録・編集・削除
   - JSON形式のテストデータ管理
   - テストデータのカテゴリ分類（APIエンドポイント別など）
   - テストデータの検索・フィルタリング

3. **モックサーバー機能**
   - APIエンドポイントのモック定義
   - レスポンスデータの設定
   - HTTPステータスコードの設定
   - モックエンドポイントの有効化/無効化

4. **ログビューアー**
   - ログのアップロード・表示
   - ログの検索機能（キーワード検索）
   - ログレベルのフィルタリング（INFO, WARN, ERROR）
   - ログの時系列表示

#### Phase 2: 拡張機能（MVP外）
- 環境設定管理
- エラーパターン分析
- 通知機能
- ユーザー認証・権限管理

## 4. データモデル

### 4.1 エンティティ設計

#### API仕様（ApiSpec）
- `id`: 主キー
- `name`: 仕様名
- `version`: バージョン
- `openapi_spec`: OpenAPI仕様（JSON形式）
- `description`: 説明
- `created_at`: 作成日時
- `updated_at`: 更新日時

#### テストデータ（TestData）
- `id`: 主キー
- `name`: データ名
- `category`: カテゴリ（APIエンドポイント名など）
- `data`: テストデータ（JSON形式）
- `description`: 説明
- `tags`: タグ（カンマ区切り）
- `created_at`: 作成日時
- `updated_at`: 更新日時

#### モックエンドポイント（MockEndpoint）
- `id`: 主キー
- `path`: エンドポイントパス（例: `/api/v1/users/{id}`）
- `method`: HTTPメソッド（GET, POST, PUT, DELETE）
- `status_code`: HTTPステータスコード
- `response_body`: レスポンスボディ（JSON形式）
- `response_headers`: レスポンスヘッダー（JSON形式）
- `is_active`: 有効/無効フラグ
- `description`: 説明
- `created_at`: 作成日時
- `updated_at`: 更新日時

#### ログエントリ（LogEntry）
- `id`: 主キー
- `level`: ログレベル（INFO, WARN, ERROR）
- `message`: ログメッセージ
- `source`: ログソース（アプリケーション名など）
- `metadata`: メタデータ（JSON形式）
- `created_at`: 作成日時

## 5. API設計

### 5.1 APIエンドポイント一覧

#### API仕様管理
- `GET /api/specs` - 仕様一覧取得
- `GET /api/specs/{id}` - 仕様詳細取得
- `POST /api/specs` - 仕様作成
- `PUT /api/specs/{id}` - 仕様更新
- `DELETE /api/specs/{id}` - 仕様削除
- `GET /api/specs/search?q={query}` - 仕様検索

#### テストデータ管理
- `GET /api/test-data` - テストデータ一覧取得
- `GET /api/test-data/{id}` - テストデータ詳細取得
- `POST /api/test-data` - テストデータ作成
- `PUT /api/test-data/{id}` - テストデータ更新
- `DELETE /api/test-data/{id}` - テストデータ削除
- `GET /api/test-data/search?q={query}&category={category}` - テストデータ検索

#### モックサーバー
- `GET /api/mocks` - モックエンドポイント一覧取得
- `GET /api/mocks/{id}` - モックエンドポイント詳細取得
- `POST /api/mocks` - モックエンドポイント作成
- `PUT /api/mocks/{id}` - モックエンドポイント更新
- `DELETE /api/mocks/{id}` - モックエンドポイント削除
- `GET /api/mocks/active` - 有効なモックエンドポイント一覧取得
- `{method} /mock/{path}` - モックエンドポイント（動的ルーティング）

#### ログビューアー
- `GET /api/logs` - ログ一覧取得（ページネーション対応）
- `GET /api/logs/{id}` - ログ詳細取得
- `POST /api/logs` - ログアップロード（一括）
- `GET /api/logs/search?q={query}&level={level}` - ログ検索

## 6. UI設計

### 6.1 ページ構成

#### メインページ（`/`）
- ダッシュボード
- 各機能へのクイックアクセス
- 最近のアクティビティ表示

#### API仕様管理ページ（`/specs`）
- 仕様一覧表示
- 仕様の追加・編集・削除
- 仕様の検索
- OpenAPI仕様のプレビュー

#### テストデータ管理ページ（`/test-data`）
- テストデータ一覧表示
- テストデータの追加・編集・削除
- カテゴリ・タグでのフィルタリング
- JSONエディタ

#### モックサーバーページ（`/mocks`）
- モックエンドポイント一覧表示
- モックエンドポイントの追加・編集・削除
- 有効/無効の切り替え
- モックエンドポイントのテスト

#### ログビューアーページ（`/logs`）
- ログ一覧表示（時系列）
- ログレベルのフィルタリング
- ログの検索
- ログのアップロード

### 6.2 UI/UX要件
- **レスポンシブデザイン**: モバイル対応
- **HTMX使用**: ページ遷移なしの動的更新
- **シンプルなUI**: 開発者が使いやすい直感的なインターフェース
- **エラーハンドリング**: 適切なエラーメッセージ表示

## 7. 技術的制約・要件

### 7.1 パフォーマンス要件
- APIレスポンス時間: 200ms以下（通常のCRUD操作）
- ログ検索: 1000件/秒の処理能力

### 7.2 セキュリティ要件（MVP）
- 基本的な入力検証
- SQLインジェクション対策（SQLModel使用）
- XSS対策（HTMXの自動エスケープ）

### 7.3 データベース
- MVPではSQLiteを使用
- 本番環境ではPostgreSQLへの移行を想定

### 7.4 コード品質
- DRY原則の徹底
- 再利用可能なコンポーネント設計
- 適切なエラーハンドリング

## 8. 実装フェーズ

### Phase 1: 基盤構築
1. プロジェクト構造の作成
2. FastAPIアプリケーションのセットアップ
3. SQLModelモデルの定義
4. データベースマイグレーション

### Phase 2: API実装
1. API仕様管理APIの実装
2. テストデータ管理APIの実装
3. モックサーバーAPIの実装
4. ログビューアーAPIの実装

### Phase 3: UI実装
1. ベーステンプレートの作成
2. 各ページの実装（HTMX使用）
3. フォーム・バリデーションの実装
4. エラーハンドリングの実装

### Phase 4: 統合・テスト
1. エンドツーエンドテスト
2. パフォーマンステスト
3. バグ修正
4. ドキュメント作成

## 9. 成功基準

### 9.1 MVP成功基準
- 4つの主要機能（API仕様管理、テストデータ管理、モックサーバー、ログビューアー）が動作する
- 開発者が実際に使用できるレベルまでの完成度
- 基本的なエラーハンドリングが実装されている
- ドキュメントが整備されている

## 10. 今後の拡張予定

- ユーザー認証・権限管理
- 環境設定管理機能
- エラーパターン分析機能
- 通知機能（Slack連携など）
- API仕様の自動生成
- テストデータの自動生成
- モックサーバーの高度な機能（遅延応答、条件分岐など）
